{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/home/pc/Public/zenith/gatsby-firebase-starter-NEW/src/utils/Session/withAuthorization.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport { navigate } from 'gatsby';\nimport AuthUserContext from \"./context\";\nimport { withFirebase } from \"../Firebase\";\nimport { SIGN_IN } from \"../../constants/routes\";\n\nvar withAuthorization = function withAuthorization(condition) {\n  return function (Component) {\n    var WithAuthorization = function (_React$Component) {\n      _inherits(WithAuthorization, _React$Component);\n\n      var _super = _createSuper(WithAuthorization);\n\n      function WithAuthorization() {\n        var _this;\n\n        _classCallCheck(this, WithAuthorization);\n\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        _this = _super.call.apply(_super, [this].concat(args));\n        _this._initFirebase = false;\n\n        _this.firebaseInit = function () {\n          if (_this.props.firebase && !_this._initFirebase) {\n            _this._initFirebase = true;\n            console.log('test');\n            _this.listener = _this.props.firebase.onAuthUserListener(function (authUser) {\n              console.log('test');\n\n              if (!condition(authUser)) {\n                navigate(SIGN_IN);\n              }\n            }, function () {\n              return navigate(SIGN_IN);\n            });\n          }\n        };\n\n        return _this;\n      }\n\n      _createClass(WithAuthorization, [{\n        key: \"componentDidMount\",\n        value: function componentDidMount() {\n          this.firebaseInit();\n        }\n      }, {\n        key: \"componentDidUpdate\",\n        value: function componentDidUpdate() {\n          this.firebaseInit();\n        }\n      }, {\n        key: \"componentWillUnmount\",\n        value: function componentWillUnmount() {\n          this.listener && this.listener();\n        }\n      }, {\n        key: \"render\",\n        value: function render() {\n          var _this2 = this;\n\n          return React.createElement(AuthUserContext.Consumer, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 45,\n              columnNumber: 9\n            }\n          }, function (authUser) {\n            return condition(authUser) ? React.createElement(Component, _extends({}, _this2.props, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 47,\n                columnNumber: 35\n              }\n            })) : null;\n          });\n        }\n      }]);\n\n      return WithAuthorization;\n    }(React.Component);\n\n    return withFirebase(WithAuthorization);\n  };\n};\n\nexport default withAuthorization;","map":{"version":3,"sources":["/home/pc/Public/zenith/gatsby-firebase-starter-NEW/src/utils/Session/withAuthorization.js"],"names":["React","navigate","AuthUserContext","withFirebase","SIGN_IN","withAuthorization","condition","Component","WithAuthorization","_initFirebase","firebaseInit","props","firebase","console","log","listener","onAuthUserListener","authUser"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,QAAzB;AAEA,OAAOC,eAAP;AACA,SAASC,YAAT;AACA,SAASC,OAAT;;AAEA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAAAC,SAAS;AAAA,SAAI,UAAAC,SAAS,EAAI;AAAA,QAC5CC,iBAD4C;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,cAEhDC,aAFgD,GAEhC,KAFgC;;AAAA,cAIhDC,YAJgD,GAIjC,YAAM;AACnB,cAAI,MAAKC,KAAL,CAAWC,QAAX,IAAuB,CAAC,MAAKH,aAAjC,EAAgD;AAC9C,kBAAKA,aAAL,GAAqB,IAArB;AAEAI,YAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AAEA,kBAAKC,QAAL,GAAgB,MAAKJ,KAAL,CAAWC,QAAX,CAAoBI,kBAApB,CACd,UAAAC,QAAQ,EAAI;AACVJ,cAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;;AAEA,kBAAI,CAACR,SAAS,CAACW,QAAD,CAAd,EAA0B;AACxBhB,gBAAAA,QAAQ,CAACG,OAAD,CAAR;AACD;AACF,aAPa,EAQd;AAAA,qBAAMH,QAAQ,CAACG,OAAD,CAAd;AAAA,aARc,CAAhB;AAUD;AACF,SArB+C;;AAAA;AAAA;;AAAA;AAAA;AAAA,4CAuB5B;AAClB,eAAKM,YAAL;AACD;AAzB+C;AAAA;AAAA,6CA2B3B;AACnB,eAAKA,YAAL;AACD;AA7B+C;AAAA;AAAA,+CA+BzB;AACrB,eAAKK,QAAL,IAAiB,KAAKA,QAAL,EAAjB;AACD;AAjC+C;AAAA;AAAA,iCAmCvC;AAAA;;AACP,iBACE,oBAAC,eAAD,CAAiB,QAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACG,UAAAE,QAAQ;AAAA,mBACPX,SAAS,CAACW,QAAD,CAAT,GAAsB,oBAAC,SAAD,eAAe,MAAI,CAACN,KAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAtB,GAAsD,IAD/C;AAAA,WADX,CADF;AAOD;AA3C+C;;AAAA;AAAA,MAClBX,KAAK,CAACO,SADY;;AA8ClD,WAAOJ,YAAY,CAACK,iBAAD,CAAnB;AACD,GA/CkC;AAAA,CAAnC;;AAiDA,eAAeH,iBAAf","sourcesContent":["import React from 'react';\nimport { navigate } from 'gatsby';\n\nimport AuthUserContext from './context';\nimport { withFirebase } from '../Firebase';\nimport { SIGN_IN } from '../../constants/routes';\n\nconst withAuthorization = condition => Component => {\n  class WithAuthorization extends React.Component {\n    _initFirebase = false;\n\n    firebaseInit = () => {\n      if (this.props.firebase && !this._initFirebase) {\n        this._initFirebase = true;\n\n        console.log('test');\n\n        this.listener = this.props.firebase.onAuthUserListener(\n          authUser => {\n            console.log('test');\n\n            if (!condition(authUser)) {\n              navigate(SIGN_IN);\n            }\n          },\n          () => navigate(SIGN_IN),\n        );\n      }\n    };\n\n    componentDidMount() {\n      this.firebaseInit();\n    }\n\n    componentDidUpdate() {\n      this.firebaseInit();\n    }\n\n    componentWillUnmount() {\n      this.listener && this.listener();\n    }\n\n    render() {\n      return (\n        <AuthUserContext.Consumer>\n          {authUser =>\n            condition(authUser) ? <Component {...this.props} /> : null\n          }\n        </AuthUserContext.Consumer>\n      );\n    }\n  }\n\n  return withFirebase(WithAuthorization);\n};\n\nexport default withAuthorization;\n"]},"metadata":{},"sourceType":"module"}